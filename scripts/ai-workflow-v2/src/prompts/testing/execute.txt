# テスト実行フェーズ - 実行プロンプト

## タスク概要
Phase 5で実装したテストコードを実行し、結果を記録してください。

## ⚠️ このフェーズが不要と判断した場合の対応（Issue #411）

**重要**: このIssueでテスト実行が不要と判断した場合でも、**必ずtest-result.mdファイルを作成**してください。
ファイルが作成されないと、ワークフローがエラーで停止します。

### スキップ判断の基準
以下のような場合、テスト実行をスキップすることが適切です：
- Phase 5でテストコード実装がスキップされた場合
- ドキュメント修正のみのIssue
- ファイル削除のみのIssue
- 設定ファイルの微修正のみのIssue
- テスト対象となる実装コードが存在しないIssue

### スキップ時のファイル作成（必須）
スキップすると判断した場合、以下のテンプレートで必ずtest-result.mdを作成してください：

```markdown
# テスト実行結果

## スキップ判定
このIssueではテスト実行が不要と判断しました。

## 判定理由
- （具体的な理由を箇条書きで記載）
- 例: Phase 5でテストコード実装がスキップされたため、実行するテストが存在しない
- 例: ドキュメント修正のみのため、テスト実行は不要

## 次フェーズへの推奨
Phase 7（Documentation）へ進んでください。
```

**注意**: Phase 5でtest-implementation.mdにスキップ判定が記載されている場合は、このフェーズもスキップすることを推奨します。

## 入力情報

### Planning Phase成果物
- Planning Document: {planning_document_path}

**注意**: Planning Phaseが実行されている場合、開発計画（実装戦略、テスト戦略、リスク、スケジュール）を必ず確認してください。

### テスト実装ログ（利用可能な場合）
{test_implementation_context}
<!--
  存在する場合: @test-implementation.md への参照
  存在しない場合: "テストコード実装ログは利用できません。実装コードを直接確認してテストを実行してください。"
-->

### 実装ログ（利用可能な場合）
{implementation_context}
<!--
  存在する場合: @implementation.md への参照
  存在しない場合: "実装ログは利用できません。リポジトリの実装コードを直接確認してください。"
-->

### テストシナリオ（利用可能な場合）
{test_scenario_context}
<!--
  存在する場合: @test-scenario.md への参照
  存在しない場合: "テストシナリオは利用できません。実装内容に基づいて適切なテストを実施してください。"
-->

## テスト実行手順

### 1. テストコードの確認

テスト実装ログに記載されたテストファイルを確認してください：
- 実装されたテストファイルのパス
- テストフレームワーク（pytest, unittest, behave等）
- テスト実行コマンド

### 2. テストの実行

適切なテストコマンドを実行してください：

**Pytestの場合**:
```bash
pytest tests/
```

**Unittestの場合**:
```bash
python -m unittest discover tests/
```

**Behave（BDD）の場合**:
```bash
behave tests/features/
```

**プロジェクト固有のテストコマンド**:
- @README.md や@CONTRIBUTION.md にテスト実行方法が記載されている場合があります
- 既存のテストスクリプトがあれば参考にしてください

### 3. テスト結果の記録

テスト結果を以下の形式で記録してください：

```markdown
# テスト実行結果

## 実行サマリー
- **実行日時**: YYYY-MM-DD HH:MM:SS
- **テストフレームワーク**: pytest/unittest/behave等
- **総テスト数**: X個
- **成功**: Y個
- **失敗**: Z個
- **スキップ**: W個

## テスト実行コマンド
\```bash
（実行したコマンド）
\```

## 成功したテスト

### テストファイル1: path/to/test_xxx.py
- ✅ test_function1: （テスト内容）
- ✅ test_function2: （テスト内容）

## 失敗したテスト

（失敗がある場合のみ記載）

### テストファイル1: path/to/test_xxx.py
- ❌ test_function3: （テスト内容）
  - **エラー内容**: （エラーメッセージ）
  - **原因分析**: （なぜ失敗したか）
  - **対処方針**: （どう修正すべきか）

## テスト出力

\```
（テスト実行の完全な出力）
\```

## 判定

- [ ] **すべてのテストが成功**
- [ ] **一部のテストが失敗**
- [ ] **テスト実行自体が失敗**

## 次のステップ

- すべて成功: Phase 7（ドキュメント作成）へ進む
- 一部失敗: Phase 5（テストコード実装）に戻って修正が必要
- 実行失敗: テスト環境の確認が必要
```

このログを `.ai-workflow/issue-{issue_number}/06_testing/output/test-result.md` として保存してください。

## 品質ゲート（Phase 6）

テスト実行は以下の品質ゲートを満たす必要があります：

- [ ] **テストが実行されている**
- [ ] **主要なテストケースが成功している**
- [ ] **失敗したテストは分析されている**

これらの品質ゲートは**必須要件**です。テスト実行後、クリティカルシンキングレビューが実施されます。

## 注意事項

1. **テスト環境**: 適切なテスト環境で実行
   - 必要な依存パッケージがインストールされているか確認
   - テストデータが準備されているか確認

2. **失敗の分析**: テストが失敗した場合は詳細に分析
   - エラーメッセージを記録
   - 原因を特定
   - 修正方針を明記

3. **完全性**: すべてのテストを実行
   - 一部だけでなく、すべてのテストを実行
   - スキップされたテストがある場合は理由を記載

4. **客観性**: 結果を正直に記録
   - 失敗を隠さない
   - 成功・失敗を正確に報告

5. **レビューされることを意識**: テスト結果はクリティカルシンキングレビューが実施されます
   - 品質ゲート（3つの必須要件）を満たすこと
   - テスト失敗時は原因分析と対処方針を明記

## テスト実行開始

上記を踏まえ、テストを実行し、結果を記録してください。
