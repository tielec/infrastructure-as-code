# 要件定義書: Issue #538

## ファイルサイズの削減: README.md

**作成日**: 2025-12-27
**Issue**: [#538](https://github.com/tielec/infrastructure-as-code/issues/538)
**優先度**: medium
**分類**: refactor, code-quality

---

## 0. Planning Documentの確認

Planning Documentで策定された戦略を以下に要約します。

### 開発計画の全体像

- **実装戦略**: REFACTOR（既存コンテンツの構造改善）
- **テスト戦略**: INTEGRATION_ONLY（リンクチェック、Markdown構文検証）
- **見積もり工数**: 8-12時間
- **複雑度**: 中程度（10+ファイルの作成・修正）

### スコープ

README.md（759行）を複数のドキュメント（12ファイル）に分割し、約100行に縮小する。

### 主要リスク

1. リンク切れの発生
2. CLAUDE.mdからの参照破壊
3. 利用者の混乱
4. 外部参照（Wiki、CI）の破壊

---

## 1. 概要

### 1.1 背景

README.mdが759行の単一ドキュメントに肥大化し、以下の問題が発生している：

- セットアップ・ブートストラップ・AI Workflow移行履歴・運用手順が混在
- 役割別に必要情報へ辿り着きにくい
- 更新時に意図せぬ整合性崩壊や重複が生じやすい
- オンボーディングの遅延
- 運用変更やAI Workflowの改訂が周知しにくい

### 1.2 目的

docs/配下に目的別の短いドキュメントを分割し、README.mdは概要と主要リンクのみとすることで、以下を実現する：

- 更新コストの低減
- 参照性の向上
- 情報の役割分担の明確化
- 更新責任範囲の縮小
- レビュー容易性の向上
- ドキュメント信頼性の向上

### 1.3 価値

| 観点 | 価値 |
|------|------|
| **技術的価値** | ドキュメント管理の効率化、メンテナンス性の向上、変更影響範囲の局所化 |
| **ビジネス価値** | オンボーディング時間の短縮、運用知識の伝達効率向上、チーム生産性の向上 |

---

## 2. 機能要件

### 2.1 ドキュメント分割（優先度: 高）

| ID | 要件 | 分割先 | 推定行数 |
|----|------|--------|----------|
| FR-001 | 変更履歴セクション（行11-30）を分離する | docs/changelog.md | 20行 |
| FR-002 | 前提条件 + EC2キーペアセクション（行31-59）を分離する | docs/setup/prerequisites.md | 29行 |
| FR-003 | ブートストラップ構築セクション（行60-257）を分離する | docs/setup/bootstrap.md | 198行 |
| FR-004 | Pulumiバックエンド設定セクション（行258-311）を分離する | docs/setup/pulumi-backend.md | 54行 |
| FR-005 | Jenkinsインフラデプロイセクション（行312-430）を分離する | docs/operations/jenkins-deploy.md | 119行 |
| FR-006 | Jenkins環境運用管理セクション（行431-480）を分離する | docs/operations/jenkins-management.md | 50行 |
| FR-007 | ブートストラップ管理セクション（行481-519）を分離する | docs/operations/bootstrap-management.md | 39行 |
| FR-008 | インフラ削除セクション（行520-565）を分離する | docs/operations/infrastructure-teardown.md | 46行 |
| FR-009 | インフラ構成セクション（行566-672）を分離する | docs/architecture/infrastructure.md | 107行 |
| FR-010 | トラブルシューティングセクション（行673-704）を分離する | docs/troubleshooting.md | 32行 |
| FR-011 | 共有パラメータ・注意事項セクション（行705-730）を分離する | docs/operations/parameters.md | 26行 |
| FR-012 | 拡張方法セクション（行731-759）を分離する | docs/development/extension.md | 29行 |

### 2.2 README.md縮小（優先度: 高）

| ID | 要件 | 詳細 |
|----|------|------|
| FR-013 | README.mdを約100行以下に縮小する | 概要セクションを維持し、目次とリンクのみで構成 |
| FR-014 | クイックナビゲーション（目次）を作成する | 役割別に分割ドキュメントへのリンクを提供 |
| FR-015 | 重要なドキュメントセクションを維持・更新する | ARCHITECTURE.md, CLAUDE.md, CONTRIBUTION.mdへのリンク |

### 2.3 ディレクトリ構造作成（優先度: 高）

| ID | 要件 | 詳細 |
|----|------|------|
| FR-016 | docs/setup/ディレクトリを作成する | セットアップ関連ドキュメント格納用 |
| FR-017 | docs/operations/ディレクトリを作成する | 運用関連ドキュメント格納用 |
| FR-018 | docs/architecture/ディレクトリを作成する | アーキテクチャ関連ドキュメント格納用 |
| FR-019 | docs/development/ディレクトリを作成する | 開発関連ドキュメント格納用 |

### 2.4 参照更新（優先度: 高）

| ID | 要件 | 詳細 |
|----|------|------|
| FR-020 | CLAUDE.mdのREADME.md参照を更新する | 新しいドキュメント構造に合わせたリンク更新 |
| FR-021 | 各分割ドキュメントに「親ドキュメントに戻る」リンクを追加する | ナビゲーション改善のため |

### 2.5 品質保証（優先度: 中）

| ID | 要件 | 詳細 |
|----|------|------|
| FR-022 | 全ての内部リンクが有効であることを確認する | リンクチェッカーによる検証 |
| FR-023 | Markdown構文エラーがないことを確認する | Markdown Linterによる検証 |

---

## 3. 非機能要件

### 3.1 可読性（NFR-001）

- 1ドキュメントあたり100-200行を目安とする
- 論理的に関連するセクションは同一ファイルに維持する
- 各ドキュメントに適切なヘッダー（タイトル、概要）を設定する

### 3.2 保守性（NFR-002）

- ファイル命名規則: kebab-case（例: `jenkins-deploy.md`）
- ディレクトリ命名規則: lowercase単語（例: `setup/`, `operations/`）
- アンカー命名規則: kebab-case（例: `#ec2-key-pair-creation`）
- 各ドキュメントのフォーマットを統一する

### 3.3 アクセシビリティ（NFR-003）

- README.mdから全ての分割ドキュメントへ2クリック以内でアクセス可能
- 各分割ドキュメントからREADME.mdへ1クリックで戻れる
- 関連ドキュメント間のクロスリンクを適切に設置

### 3.4 一貫性（NFR-004）

- 既存のドキュメント内容は原則そのまま維持（配置場所のみ変更）
- 既存のアンカーリンク命名規則を踏襲
- プロジェクトのコーディングガイドライン（CLAUDE.md）に準拠

---

## 4. 制約事項

### 4.1 技術的制約

| ID | 制約 | 詳細 |
|----|------|------|
| C-001 | Markdown形式で記述 | GitHub上での表示互換性を維持 |
| C-002 | 相対パスリンクを使用 | リポジトリ移動時の影響を最小化 |
| C-003 | 既存のdocs/issues/ディレクトリは維持 | Issue分析用ドキュメント（既存）を破壊しない |

### 4.2 リソース制約

| ID | 制約 | 詳細 |
|----|------|------|
| C-004 | 見積もり工数内（8-12時間）で完了 | Planning Documentで策定 |
| C-005 | ドキュメント作業のみ（コード変更なし） | テストは最小限（リンクチェック） |

### 4.3 ポリシー制約

| ID | 制約 | 詳細 |
|----|------|------|
| C-006 | 日本語でドキュメント記述 | CLAUDE.mdのコーディングガイドラインに準拠 |
| C-007 | コミットメッセージ規約に準拠 | `[docs] refactor: README.mdをdocs/配下に分割` 形式 |

---

## 5. 前提条件

### 5.1 システム環境

| ID | 前提条件 | 詳細 |
|----|----------|------|
| P-001 | GitHubリポジトリへのアクセス権限 | ドキュメント編集・コミット権限 |
| P-002 | Markdownレンダリング環境 | GitHub上でのプレビュー確認可能 |

### 5.2 依存コンポーネント

| ID | 前提条件 | 詳細 |
|----|----------|------|
| P-003 | README.md（現行759行）が存在する | 分割元ドキュメント |
| P-004 | CLAUDE.mdが存在する | 参照更新対象 |
| P-005 | docs/issues/ディレクトリが存在する | 既存構造の維持 |

### 5.3 外部依存

| ID | 前提条件 | 詳細 |
|----|----------|------|
| P-006 | 社内WikiからのREADME.md参照状況の確認 | 影響範囲調査で確認必要 |
| P-007 | CIスクリプトからのREADME.md参照状況の確認 | 影響範囲調査で確認必要 |

---

## 6. 受け入れ基準

### 6.1 ドキュメント分割の受け入れ基準

#### AC-001: 分割ドキュメントの作成完了

```gherkin
Given README.mdが759行存在する
When ドキュメント分割を実施する
Then 12個の新規ドキュメントがdocs/配下に作成される
  And 各ドキュメントは対応するセクションの内容を含む
  And 各ドキュメントに適切なヘッダー（タイトル）が設定される
```

#### AC-002: README.mdの縮小完了

```gherkin
Given README.mdが759行存在する
When ドキュメント分割を実施する
Then README.mdは約100行以下になる
  And 概要セクションが維持される
  And 全ての分割ドキュメントへのリンクが含まれる
```

### 6.2 ディレクトリ構造の受け入れ基準

#### AC-003: ディレクトリ構造の作成完了

```gherkin
Given docs/ディレクトリが存在する
When ディレクトリ構造を作成する
Then docs/setup/ディレクトリが存在する
  And docs/operations/ディレクトリが存在する
  And docs/architecture/ディレクトリが存在する
  And docs/development/ディレクトリが存在する
  And docs/issues/ディレクトリが維持される
```

### 6.3 リンク整合性の受け入れ基準

#### AC-004: 内部リンクの有効性確認

```gherkin
Given 全てのMarkdownドキュメントが作成される
When リンクチェックを実行する
Then 全ての内部リンクが200ステータスを返す
  And リンク切れが0件である
```

#### AC-005: CLAUDE.mdの参照更新

```gherkin
Given CLAUDE.mdがREADME.mdを参照している
When 参照元を更新する
Then CLAUDE.md内の全てのREADME.md参照が有効である
  And 新しいドキュメント構造に対応したリンクが設定される
```

### 6.4 ナビゲーションの受け入れ基準

#### AC-006: 親ドキュメントへの戻りリンク

```gherkin
Given 分割ドキュメントが作成される
When 各ドキュメントを確認する
Then 全ての分割ドキュメントにREADME.mdへの戻りリンクが存在する
```

### 6.5 品質の受け入れ基準

#### AC-007: Markdown構文の正確性

```gherkin
Given 全てのMarkdownドキュメントが作成される
When Markdown Linterを実行する
Then 構文エラーが0件である
```

---

## 7. スコープ外

### 7.1 明確にスコープ外とする事項

| ID | 項目 | 理由 |
|----|------|------|
| OS-001 | ドキュメント内容の書き換え・改善 | 本Issueは構造改善のみが対象 |
| OS-002 | 新規ドキュメントの追加（計画外） | Planning Documentで定義された12ファイルのみ |
| OS-003 | 静的サイトジェネレーター（MkDocs等）の導入 | 将来的な改善提案として記録 |
| OS-004 | バージョン管理されたドキュメントの実装 | 将来的な改善提案として記録 |
| OS-005 | 外部Wiki・CIスクリプトの直接修正 | 影響調査と告知のみ実施 |
| OS-006 | ARCHITECTURE.md、CONTRIBUTION.mdの変更 | 影響なし確認のみ |

### 7.2 将来的な拡張候補

| ID | 項目 | 概要 |
|----|------|------|
| FE-001 | docs/内にINDEX.mdを作成 | 全ドキュメントの索引を提供 |
| FE-002 | MkDocs/Docsifyの導入 | 静的サイトとしてドキュメントを公開 |
| FE-003 | バージョン管理されたドキュメント | リリースごとのスナップショット作成 |
| FE-004 | 自動リンクチェックのCI統合 | PRマージ時にリンク切れを自動検出 |

---

## 8. 成果物一覧

### 8.1 新規作成ファイル（12ファイル）

| # | ファイルパス | 内容 |
|---|-------------|------|
| 1 | docs/changelog.md | 変更履歴 |
| 2 | docs/troubleshooting.md | トラブルシューティング |
| 3 | docs/setup/prerequisites.md | 前提条件 |
| 4 | docs/setup/bootstrap.md | ブートストラップ構築 |
| 5 | docs/setup/pulumi-backend.md | Pulumiバックエンド設定 |
| 6 | docs/operations/jenkins-deploy.md | Jenkinsインフラデプロイ |
| 7 | docs/operations/jenkins-management.md | Jenkins環境運用管理 |
| 8 | docs/operations/bootstrap-management.md | ブートストラップ管理 |
| 9 | docs/operations/infrastructure-teardown.md | インフラ削除 |
| 10 | docs/operations/parameters.md | 共有パラメータ・注意事項 |
| 11 | docs/architecture/infrastructure.md | インフラ構成 |
| 12 | docs/development/extension.md | 拡張方法 |

### 8.2 変更ファイル（2ファイル）

| # | ファイルパス | 変更内容 |
|---|-------------|----------|
| 1 | README.md | 大幅縮小（759行 → 約100行） |
| 2 | CLAUDE.md | 参照パス更新（必要に応じて） |

### 8.3 確認ファイル（変更なし）

| # | ファイルパス | 確認内容 |
|---|-------------|----------|
| 1 | CONTRIBUTION.md | 影響なし確認 |
| 2 | ARCHITECTURE.md | 影響なし確認 |

---

## 9. 品質ゲート確認

### Phase 1: 要件定義の品質ゲート

- [x] **機能要件が明確に記載されている**: FR-001〜FR-023で具体的に定義
- [x] **受け入れ基準が定義されている**: AC-001〜AC-007でGiven-When-Then形式で記述
- [x] **スコープが明確である**: スコープ外セクションで明確に定義
- [x] **論理的な矛盾がない**: 機能要件、受け入れ基準、制約事項間で整合性確認済み

---

**要件定義書作成完了**: 2025-12-27
**次のステップ**: Phase 2（設計）の実施
