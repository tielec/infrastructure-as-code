# テスト実行フェーズ - 修正プロンプト

## タスク概要
レビューで指摘された問題を修正し、テストを再実行してください。

**重要**: Phase 5でテストが失敗した場合、**Phase 4（実装）に戻って実装を修正**する必要があります。

## レビュー結果
## 品質ゲート評価

**⚠️ 重要: 各項目に対して明示的にPASS/FAILを判定してください。1つでもFAILがあれば最終判定は自動的にFAILです。**

- [ ] **テストが実行されている**: **FAIL** - AI環境の制約により、実際のテスト実行は行われていません。テストシナリオと実行ガイドの作成までが完了していますが、Jenkins環境での手動テスト実行が未実施です。
- [ ] **主要なテストケースが成功している**: **FAIL** - テストが実行されていないため、テストケースの成功/失敗を評価できません。
- [x] **失敗したテストは分析されている**: **PASS** - テストが実行されていないため該当なし（N/A扱い）。ただし、テスト実行時のトラブルシューティングガイドは完備されています。

**品質ゲート総合判定: FAIL**
- FAIL: 上記3項目のうち2項目がFAIL（テスト未実行のため）

**品質ゲート判定がFAILの場合、最終判定は自動的にFAILになります。**

---

## Planning Phaseチェックリスト照合結果
Planning.mdのPhase 6セクションを確認しました。以下のタスクが定義されています：

**Phase 6のタスク一覧**:
- Task 6-1: シードジョブ実行
- Task 6-2: テストケース1実行（ドラフトPRスキップ）
- Task 6-3: テストケース2実行（ドラフト解除後実行）
- Task 6-4: テストケース3実行（非ドラフトPR回帰テスト）

**照合結果**: すべてのタスクが**未完了**（実行待ち）

理由: テスト結果ドキュメントには詳細なテストシナリオと実行ガイドが作成されていますが、**実際のテスト実行はJenkins環境で行われていません**。AI環境の制約により手動テスト待ちの状態です。

Planning.mdを更新する必要はありません（タスクはすべて`[ ]`のまま、実際にテストが実行されるまで変更不要）。

---

## 詳細レビュー

### 1. テスト実行の確認

**懸念点**:
- ❌ **テストが全く実行されていない**: AI環境の制約により、Jenkins環境での手動テスト実行が未実施です
- ❌ テスト実行コマンドが記録されていない（実行されていないため）
- ❌ テスト出力が記録されていない（実行されていないため）

**現状の成果**:
- ✅ 詳細なテストシナリオが作成されている（Phase 3）
- ✅ 手動テスト実行ガイドが完備されている
- ✅ 5つのテストケース（TC1〜TC5）が定義されている
- ✅ 各テストケースの実行手順、期待結果、確認項目チェックリストが文書化されている

### 2. 主要テストケースの成功

**懸念点**:
- ❌ **テストが実行されていないため、成功/失敗を評価できない**
- テストケース1（ドラフトPRスキップ）: 未実行
- テストケース2（ドラフト解除後実行）: 未実行
- テストケース3（非ドラフトPR回帰テスト）: 未実行
- テストケース4（パラメータ欠落時のフェイルセーフ）: 未実行
- テストケース5（シードジョブでのDSL反映確認）: 未実行

### 3. 失敗したテストの分析

**良好な点**:
- ✅ トラブルシューティングガイドが事前に作成されている
- ✅ よくある問題とその対処法が文書化されている
- ✅ テスト結果記録テンプレートが用意されている

**現状**:
- N/A: テストが実行されていないため、失敗したテストは存在しない

### 4. テスト範囲

**良好な点**:
- ✅ テストシナリオは包括的（5つのテストケースで主要な機能をカバー）
- ✅ 正常系、異常系、回帰テスト、フェイルセーフが含まれている
- ✅ テスト実行順序と見積もり時間（合計2時間）が明確

**懸念点**:
- ❌ 実際のテスト実行が未実施のため、テスト範囲が実証されていない

---

## ブロッカー（BLOCKER）

**次フェーズに進めない重大な問題**

### 1. **テスト未実行により品質が検証されていない**
   - **問題**: Jenkins環境での手動テストが全く実行されていないため、実装コードの動作が検証されていません
   - **影響**: 実装に重大なバグがある可能性があり、そのまま次フェーズ（ドキュメント作成）に進むことは危険です
   - **対策**: Jenkins管理者が以下を実施する必要があります
     1. **最優先**: TC5（シードジョブ実行）を実行してDSL変更を反映
     2. TC1〜TC4を実行して機能を検証
     3. テスト結果をtest-result.mdに追記
     4. すべてのテストがPASSの場合のみPhase 7へ進む
     5. FAILがある場合はPhase 4（実装）に戻って修正

### 2. **AI Workflowの役割と実際の作業の境界が不明確**
   - **問題**: test-result.mdには「AI Workflowとしての役割は完了」と記載されていますが、Phase 6の品質ゲートは「テストが実行されている」「主要なテストケースが成功している」であり、これらは満たされていません
   - **影響**: AI Workflowとして本当にPhase 6を完了したと言えるのか疑問が残ります
   - **対策**: 以下のいずれかの対応が必要です
     - **対策A（推奨）**: Jenkins管理者がテストを実行し、結果を記録してからPhase 6完了とする
     - **対策B**: Planning.mdのPhase 6品質ゲートを修正し、「AI環境での完了基準」と「人間による作業」を明確に分離する（ただし、これは元のWorkflow定義の変更になるため推奨しない）

---

## 改善提案（SUGGESTION）

**該当なし**: ブロッカーが解消されるまで改善提案は無意味です。まずはテスト実行を完了させてください。

---

## 総合評価

### 現状の評価

**AI Workflowとしての準備作業**:
- ✅ テストシナリオ作成: 優秀（詳細で実用的）
- ✅ テスト実行ガイド作成: 優秀（実施者が迷わないレベル）
- ✅ トラブルシューティングガイド: 充実
- ✅ テスト結果記録テンプレート: 用意済み
- ✅ 実装コードの品質: Phase 4でレビュー済み

**Phase 6の品質ゲート達成状況**:
- ❌ テストが実行されている: **未達成**
- ❌ 主要なテストケースが成功している: **未達成**
- ⚠️ 失敗したテストは分析されている: **N/A**（テスト未実行のため）

### 根本的な問題

このissueは**AI環境では完全な自動化ができない性質**のタスクです。しかし、Planning.md（Phase 0）で策定されたPhase 6の品質ゲートは「テストが実行されている」「主要なテストケースが成功している」であり、これは**実際のテスト実行を前提**としています。

**判断基準の矛盾**:
- Planning.mdのPhase 6品質ゲート: テスト実行を要求
- AI環境の制約: テスト実行不可能
- test-result.mdの判断: AI Workflowの役割は完了（テスト準備まで）

この矛盾を解消するには、**実際にテストを実行する**か、**Planning.mdの品質ゲートを修正する**かのいずれかが必要です。

### 主な懸念点

1. **品質ゲート未達成**: 3項目中2項目が未達成（テスト未実行）
2. **実装の検証ゼロ**: コードが実際に動作するか確認されていない
3. **リスク**: ドキュメント作成（Phase 7）に進んでも、後からテスト失敗が判明する可能性が高い

### 推奨アクション

**最優先**: Jenkins管理者が手動テストを実行
1. テストケース5（シードジョブ実行）を最初に実行
2. テストケース1〜4を順番に実行（見積もり2時間）
3. テスト結果をtest-result.mdに追記
4. すべてPASSの場合: Phase 7（Documentation）へ進む
5. FAILがある場合: Phase 4（実装）に戻って修正

---

**判定: FAIL**

**理由**: 品質ゲート3項目中2項目が未達成（テスト未実行により検証不可能）。AI Workflowとしての準備作業は優秀ですが、Phase 6の必須要件である「テストが実行されている」「主要なテストケースが成功している」が満たされていないため、次フェーズに進むことはできません。Jenkins環境での手動テスト実行が必須です。
Planning.mdのPhase 6セクションを確認しました。以下のタスクが定義されています：

**Phase 6のタスク一覧**:
- Task 6-1: シードジョブ実行
- Task 6-2: テストケース1実行（ドラフトPRスキップ）
- Task 6-3: テストケース2実行（ドラフト解除後実行）
- Task 6-4: テストケース3実行（非ドラフトPR回帰テスト）

**照合結果**: すべてのタスクが**未完了**（実行待ち）

理由: テスト結果ドキュメントには詳細なテストシナリオと実行ガイドが作成されていますが、**実際のテスト実行はJenkins環境で行われていません**。AI環境の制約により手動テスト待ちの状態です。

Planning.mdを更新する必要はありません（タスクはすべて`[ ]`のまま、実際にテストが実行されるまで変更不要）。

---

## 詳細レビュー

### 1. テスト実行の確認

**懸念点**:
- ❌ **テストが全く実行されていない**: AI環境の制約により、Jenkins環境での手動テスト実行が未実施です
- ❌ テスト実行コマンドが記録されていない（実行されていないため）
- ❌ テスト出力が記録されていない（実行されていないため）

**現状の成果**:
- ✅ 詳細なテストシナリオが作成されている（Phase 3）
- ✅ 手動テスト実行ガイドが完備されている
- ✅ 5つのテストケース（TC1〜TC5）が定義されている
- ✅ 各テストケースの実行手順、期待結果、確認項目チェックリストが文書化されている

### 2. 主要テストケースの成功

**懸念点**:
- ❌ **テストが実行されていないため、成功/失敗を評価できない**
- テストケース1（ドラフトPRスキップ）: 未実行
- テストケース2（ドラフト解除後実行）: 未実行
- テストケース3（非ドラフトPR回帰テスト）: 未実行
- テストケース4（パラメータ欠落時のフェイルセーフ）: 未実行
- テストケース5（シードジョブでのDSL反映確認）: 未実行

### 3. 失敗したテストの分析

**良好な点**:
- ✅ トラブルシューティングガイドが事前に作成されている
- ✅ よくある問題とその対処法が文書化されている
- ✅ テスト結果記録テンプレートが用意されている

**現状**:
- N/A: テストが実行されていないため、失敗したテストは存在しない

### 4. テスト範囲

**良好な点**:
- ✅ テストシナリオは包括的（5つのテストケースで主要な機能をカバー）
- ✅ 正常系、異常系、回帰テスト、フェイルセーフが含まれている
- ✅ テスト実行順序と見積もり時間（合計2時間）が明確

**懸念点**:
- ❌ 実際のテスト実行が未実施のため、テスト範囲が実証されていない

---

## ブロッカー（BLOCKER）

**次フェーズに進めない重大な問題**

### 1. **テスト未実行により品質が検証されていない**
   - **問題**: Jenkins環境での手動テストが全く実行されていないため、実装コードの動作が検証されていません
   - **影響**: 実装に重大なバグがある可能性があり、そのまま次フェーズ（ドキュメント作成）に進むことは危険です
   - **対策**: Jenkins管理者が以下を実施する必要があります
     1. **最優先**: TC5（シードジョブ実行）を実行してDSL変更を反映
     2. TC1〜TC4を実行して機能を検証
     3. テスト結果をtest-result.mdに追記
     4. すべてのテストがPASSの場合のみPhase 7へ進む
     5. FAILがある場合はPhase 4（実装）に戻って修正

### 2. **AI Workflowの役割と実際の作業の境界が不明確**
   - **問題**: test-result.mdには「AI Workflowとしての役割は完了」と記載されていますが、Phase 6の品質ゲートは「テストが実行されている」「主要なテストケースが成功している」であり、これらは満たされていません
   - **影響**: AI Workflowとして本当にPhase 6を完了したと言えるのか疑問が残ります
   - **対策**: 以下のいずれかの対応が必要です
     - **対策A（推奨）**: Jenkins管理者がテストを実行し、結果を記録してからPhase 6完了とする
     - **対策B**: Planning.mdのPhase 6品質ゲートを修正し、「AI環境での完了基準」と「人間による作業」を明確に分離する（ただし、これは元のWorkflow定義の変更になるため推奨しない）

---

## 改善提案（SUGGESTION）

**該当なし**: ブロッカーが解消されるまで改善提案は無意味です。まずはテスト実行を完了させてください。

---

## 総合評価

### 現状の評価

**AI Workflowとしての準備作業**:
- ✅ テストシナリオ作成: 優秀（詳細で実用的）
- ✅ テスト実行ガイド作成: 優秀（実施者が迷わないレベル）
- ✅ トラブルシューティングガイド: 充実
- ✅ テスト結果記録テンプレート: 用意済み
- ✅ 実装コードの品質: Phase 4でレビュー済み

**Phase 6の品質ゲート達成状況**:
- ❌ テストが実行されている: **未達成**
- ❌ 主要なテストケースが成功している: **未達成**
- ⚠️ 失敗したテストは分析されている: **N/A**（テスト未実行のため）

### 根本的な問題

このissueは**AI環境では完全な自動化ができない性質**のタスクです。しかし、Planning.md（Phase 0）で策定されたPhase 6の品質ゲートは「テストが実行されている」「主要なテストケースが成功している」であり、これは**実際のテスト実行を前提**としています。

**判断基準の矛盾**:
- Planning.mdのPhase 6品質ゲート: テスト実行を要求
- AI環境の制約: テスト実行不可能
- test-result.mdの判断: AI Workflowの役割は完了（テスト準備まで）

この矛盾を解消するには、**実際にテストを実行する**か、**Planning.mdの品質ゲートを修正する**かのいずれかが必要です。

### 主な懸念点

1. **品質ゲート未達成**: 3項目中2項目が未達成（テスト未実行）
2. **実装の検証ゼロ**: コードが実際に動作するか確認されていない
3. **リスク**: ドキュメント作成（Phase 7）に進んでも、後からテスト失敗が判明する可能性が高い

### 推奨アクション

**最優先**: Jenkins管理者が手動テストを実行
1. テストケース5（シードジョブ実行）を最初に実行
2. テストケース1〜4を順番に実行（見積もり2時間）
3. テスト結果をtest-result.mdに追記
4. すべてPASSの場合: Phase 7（Documentation）へ進む
5. FAILがある場合: Phase 4（実装）に戻って修正

---

**判定: FAIL**

**理由**: 品質ゲート3項目中2項目が未達成（テスト未実行により検証不可能）。AI Workflowとしての準備作業は優秀ですが、Phase 6の必須要件である「テストが実行されている」「主要なテストケースが成功している」が満たされていないため、次フェーズに進むことはできません。Jenkins環境での手動テスト実行が必須です。

## 参考情報

### テスト結果
@.ai-workflow/issue-431/06_testing/output/test-result.md

### 実装ログ
@.ai-workflow/issue-431/04_implementation/output/implementation.md

### テストシナリオ
@.ai-workflow/issue-431/03_test_scenario/output/test-scenario.md

## 修正指示

### ブロッカー（BLOCKER）の解消

レビュー結果の「ブロッカー」セクションに記載された問題は、**次フェーズに進めない重大な問題**です。

**重要な判断**:
- **クリティカルなテスト失敗がある場合**: Phase 4に戻って実装を修正する必要があります
- **テスト環境の問題の場合**: テスト環境を修正してテストを再実行します

**Phase 4に戻る判断基準**:
- クリティカルパスのテストが失敗している
- 正常系のテストが失敗している
- 実装に明らかなバグがある

**Phase 5内で対応できる問題**:
- テスト環境の設定ミス
- テストデータの準備不足
- テスト実行コマンドの誤り

### 修正方針の決定

レビュー結果を確認し、以下のいずれかを選択してください：

#### 選択肢1: Phase 4に戻って実装を修正

実装に問題がある場合は、このプロンプトでは対応できません。
**Phase 4のrevise()を実行する必要があります**。

この場合、以下を記録してください：

```markdown
# テスト失敗による実装修正の必要性

## 修正が必要な理由
（なぜPhase 4に戻る必要があるか）

## 失敗したテスト
（どのテストが失敗したか）

## 必要な実装修正
（実装のどこをどう修正すべきか）
```

これを `.ai-workflow/issue-431/06_testing/output/test-result.md` に追記してください。

#### 選択肢2: テスト環境を修正してテストを再実行

テスト環境に問題がある場合は、環境を修正してテストを再実行してください。

**修正手順**:
1. テスト環境の問題を特定
2. 環境を修正（依存パッケージのインストール、設定ファイルの修正等）
3. テストを再実行
4. テスト結果を記録

## 修正後の確認事項

修正完了後、以下を確認してください：

1. **ブロッカーが解消されたか**
   - レビューで指摘されたすべてのブロッカーに対応したか

2. **主要なテストが成功しているか**
   - クリティカルパスのテストが成功しているか

3. **次フェーズへの準備**
   - Phase 6（ドキュメント作成）に進めるか
   - またはPhase 4に戻る必要があるか

## テスト結果の更新

テストを再実行した場合、結果を `.ai-workflow/issue-{issue_number}/06_testing/output/test-result.md` に追記してください：

```markdown
## 再実行結果

### 再実行1: YYYY-MM-DD HH:MM:SS
- **修正内容**: （何を修正したか）
- **成功**: Y個
- **失敗**: Z個
- **変更**: （前回からの変化）
```

## 出力形式

**重要**: 修正後のテスト結果を `.ai-workflow/issue-{issue_number}/06_testing/output/test-result.md` として**必ず上書き保存**してください。既存のファイルがある場合は、古い内容を完全に置き換えて、最新のテスト結果のみを記録してください。

## 修正開始

上記を踏まえ、適切な対応を実施してください。
