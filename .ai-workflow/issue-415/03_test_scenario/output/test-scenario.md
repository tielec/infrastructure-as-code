# テストシナリオ - Issue #415

## ドキュメント情報

- **Issue番号**: #415
- **タイトル**: [FOLLOW-UP] Issue #411 - 残タスク
- **Issue URL**: https://github.com/tielec/infrastructure-as-code/issues/415
- **ラベル**: enhancement, ai-workflow-follow-up
- **作成日**: 2025年
- **作成者**: Claude AI (AI Workflow Test Scenario Agent)

---

## 0. Planning DocumentとDesign Documentの確認

### テスト戦略（Phase 2で決定）

**テスト戦略**: INTEGRATION_ONLY（統合テストのみ）

**判断根拠**:
1. **ユニットテスト不要**
   - 新規ロジックの追加なし（削除のみ）
   - テスト対象となる新規関数・クラスが存在しない
   - Issue #411で既にV1のユニットテストは削除対象となっている

2. **インテグレーションテスト必須**
   - システム全体の動作確認が重要（Git操作、Jenkinsジョブ実行）
   - V1削除後も既存のV2ジョブが正常動作することを確認
   - リンク切れやパス参照エラーがないことを確認
   - Issue #411で既に12個の統合テストが実施済み（100%成功）

3. **BDDテスト不要**
   - ユーザーストーリーの変更なし（内部実装の削除のみ）
   - エンドユーザー向け機能の追加・変更なし
   - V2の機能は変更されない

### テストコード戦略（Phase 2で決定）

**テストコード戦略**: EXTEND_TEST（既存テストの再利用）

**判断根拠**:
1. Issue #411で既に12個の統合テストを実装・実行済み
2. 同じテストケースを再実行して削除後の動作を確認
3. 新規テストファイルの作成は不要
4. 追加検証項目は小規模（ディレクトリ不存在確認、Jenkins確認）

---

# 1. テスト戦略サマリー

## 選択されたテスト戦略

**INTEGRATION_ONLY**: 統合テストのみ実施

## テスト対象の範囲

### Phase 4: Implementation
- Git操作の統合テスト（`git rm -rf`、コミット作成、プッシュ）
- バックアップブランチとの統合テスト（存在確認、復元テスト）
- ファイルシステムとの統合テスト（ディレクトリ削除確認）

### Phase 6: Testing（本フェーズ）
- Issue #411の既存統合テスト（12個）の再実行
- 削除後の追加確認項目（ディレクトリ不存在、Git履歴確認）
- Jenkins環境との統合テスト（V2ジョブ動作確認、オプション）

## テストの目的

1. **安全性保証**: V1削除が安全に実行され、バックアップから即座に復元可能であることを確認
2. **完全性保証**: V1への参照が完全削除され、リンク切れが存在しないことを確認
3. **継続性保証**: V2ジョブがJenkins環境で正常動作し、V1削除の影響がないことを確認
4. **整合性保証**: Git履歴に削除コミットが正しく記録され、ドキュメントが更新されていることを確認

---

# 2. Integrationテストシナリオ

## 2.1 Issue #411の既存テストの再利用

Issue #411で実施した12個の統合テストのうち、以下のテストを再実行します。

### INT-001: バックアップブランチ作成確認

**目的**: バックアップブランチが存在し、リモートにプッシュされていることを確認する

**前提条件**:
- Issue #411でバックアップブランチ `archive/ai-workflow-v1-python` が作成済み
- リモートリポジトリにプッシュ済み

**テスト手順**:
```bash
# 1. リモートブランチの存在確認
git ls-remote --heads origin | grep archive/ai-workflow-v1-python

# 2. ブランチ内容の確認
git fetch origin archive/ai-workflow-v1-python
git show origin/archive/ai-workflow-v1-python:scripts/ai-workflow/README.md | head -5
```

**期待結果**:
- ✅ バックアップブランチがリモートに存在する
- ✅ 出力例: `<commit-hash>	refs/heads/archive/ai-workflow-v1-python`
- ✅ ブランチ内容にV1のREADME.mdが保存されている

**確認項目**:
- [ ] バックアップブランチが存在する
- [ ] ブランチがリモートリポジトリにプッシュされている
- [ ] ブランチ内容にV1コードが保存されている

**エラーハンドリング**:
- ブランチが存在しない場合、Issue #411の作業を再確認
- 削除作業を中止し、バックアップを再作成

---

### INT-002: 復元時間測定（5分以内の制約確認）

**目的**: バックアップブランチから5分以内（できれば1秒未満）で復元できることを確認する

**前提条件**:
- INT-001が成功している
- バックアップブランチが存在する

**テスト手順**:
```bash
# 1. 復元時間測定
time git checkout archive/ai-workflow-v1-python -- scripts/ai-workflow/

# 2. 復元内容の確認
ls -la scripts/ai-workflow/ | wc -l

# 3. ファイル内容の検証（サンプル）
cat scripts/ai-workflow/README.md | head -5

# 4. 復元をクリーンアップ（テスト後）
git reset --hard HEAD
```

**期待結果**:
- ✅ 復元時間が5分以内（Issue #411で1秒未満を記録）
- ✅ 時間出力例: `real 0m0.XXXs` (1秒未満)
- ✅ すべてのファイルが正確に復元される
- ✅ 復元後のディレクトリ構造が完全である

**確認項目**:
- [ ] 復元時間が5分以内である
- [ ] ファイルが正確に復元される
- [ ] ディレクトリ構造が完全である
- [ ] ファイル内容が正確である

**パフォーマンス基準**:
- **必須**: 5分以内
- **推奨**: 1秒未満（Issue #411で達成済み）

**エラーハンドリング**:
- 復元時間が5分を超える場合、バックアップ戦略を再検討
- 復元内容が不完全な場合、バックアップブランチの整合性を確認

---

### INT-003: V1参照箇所の全数調査（削除後0件の再確認）

**目的**: V1への参照が完全削除され、削除後も0件であることを再確認する

**前提条件**:
- Issue #411でV1参照が0件確認済み
- Phase 4でV1ディレクトリが削除済み

**テスト手順**:
```bash
# 1. V1参照の検索（削除後）
grep -r "scripts/ai-workflow" \
  --exclude-dir=.git \
  --exclude-dir=.ai-workflow \
  --exclude-dir=ai-workflow \
  --exclude="*.md" \
  . || echo "参照なし（期待通り）"

# 2. リンク切れチェック（マークダウンファイル内）
find . -name "*.md" -type f ! -path "*/.git/*" ! -path "*/.ai-workflow/*" \
  -exec grep -l "scripts/ai-workflow" {} \;

# 3. Jenkins設定ファイルのチェック
grep -r "scripts/ai-workflow" jenkins/ --exclude-dir=.git || echo "参照なし"
```

**期待結果**:
- ✅ V1参照が0件である
- ✅ 出力: "参照なし（期待通り）"
- ✅ リンク切れが存在しない
- ✅ Jenkins設定ファイルにV1参照がない

**確認項目**:
- [ ] コードベース全体でV1参照が0件
- [ ] マークダウンファイル内にリンク切れがない
- [ ] Jenkins設定ファイルにV1参照がない
- [ ] 除外ディレクトリが正しく設定されている

**エラーハンドリング**:
- V1参照が見つかった場合、削除作業を中止
- 見つかった参照箇所を修正してから再度削除実行
- 必要に応じてロールバック（1秒未満）

---

### INT-008: Git操作の検証（削除コミット確認）

**目的**: 削除コミットがGit履歴に正しく記録されていることを確認する

**前提条件**:
- Phase 4でコミット作成が完了している
- リモートリポジトリにプッシュ済み

**テスト手順**:
```bash
# 1. 削除コミットの確認
git log --oneline --grep="remove.*AI Workflow V1" -n 1

# 2. 削除内容の確認
COMMIT_HASH=$(git log --oneline --grep="remove.*AI Workflow V1" -n 1 | awk '{print $1}')
git show $COMMIT_HASH --name-status | grep "^D" | wc -l

# 3. コミットメッセージの確認
git show $COMMIT_HASH --format="%B" --no-patch

# 4. コミットメッセージがCLAUDE.md準拠であることを確認
git show $COMMIT_HASH --format="%B" --no-patch | grep "\[scripts\] remove:"

# 5. Co-Authorクレジットが含まれていないことを確認
git show $COMMIT_HASH --format="%B" --no-patch | grep "Co-Authored-By" && echo "エラー: Co-Authorクレジットが含まれています" || echo "OK: Co-Authorクレジットなし"
```

**期待結果**:
- ✅ 削除コミットがGit履歴に記録されている
- ✅ 削除ファイル数が約50個である
- ✅ コミットメッセージが `[scripts] remove: AI Workflow V1...` の形式である
- ✅ Co-Authorクレジットが含まれていない（CLAUDE.md line 364準拠）
- ✅ バックアップ情報が含まれている
- ✅ 復元手順が含まれている

**確認項目**:
- [ ] 削除コミットが存在する
- [ ] 削除ファイル数が約50個
- [ ] コミットメッセージがCLAUDE.md規約に準拠している
- [ ] Co-Authorクレジットが含まれていない
- [ ] バックアップブランチ情報が含まれている
- [ ] 復元手順が含まれている

**エラーハンドリング**:
- 削除コミットが見つからない場合、Phase 4の作業を再確認
- コミットメッセージが規約違反の場合、`git commit --amend` で修正

---

## 2.2 削除後の追加確認項目

### INT-NEW-001: ディレクトリ不存在確認

**目的**: `scripts/ai-workflow/` ディレクトリが完全に削除されていることを確認する

**前提条件**:
- Phase 4でディレクトリ削除が完了している
- 削除コミットがリモートにプッシュ済み

**テスト手順**:
```bash
# 1. ディレクトリ存在確認
ls scripts/ai-workflow 2>&1

# 2. 期待されるエラーメッセージの確認
ls scripts/ai-workflow 2>&1 | grep "No such file or directory"

# 3. 親ディレクトリの確認
ls scripts/ | grep -v ai-workflow-v2
```

**期待結果**:
- ✅ `scripts/ai-workflow/` ディレクトリが存在しない
- ✅ エラーメッセージ: `ls: scripts/ai-workflow: No such file or directory`
- ✅ `scripts/` ディレクトリには `ai-workflow-v2/` のみが存在する

**確認項目**:
- [ ] ディレクトリが存在しない
- [ ] エラーメッセージが正しい
- [ ] V2ディレクトリは存在する（削除されていない）

**エラーハンドリング**:
- ディレクトリが存在する場合、Phase 4の削除作業を再確認
- `git status` で削除がステージングされているか確認

---

### INT-NEW-002: README.md変更履歴の更新確認

**目的**: README.md変更履歴セクションに削除情報が正しく記録されていることを確認する

**前提条件**:
- Phase 4でREADME.md更新が完了している
- コミットハッシュが記録済み

**テスト手順**:
```bash
# 1. README.md変更履歴セクションの確認
cat README.md | sed -n '11,30p'

# 2. 削除実行日の記録確認
grep "削除実行日" README.md

# 3. 削除コミットハッシュの記録確認
grep "削除コミット" README.md

# 4. Issue #415へのリンク確認
grep "#415" README.md
```

**期待結果**:
- ✅ 変更履歴セクションに削除情報が含まれている
- ✅ 削除実行日が記録されている（例: 2025年10月17日）
- ✅ 削除コミットハッシュが記載されている
- ✅ Issue #415へのリンクが追加されている
- ✅ バックアップ情報が記載されている
- ✅ 復元手順が明記されている

**確認項目**:
- [ ] 削除実行日が記録されている
- [ ] コミットハッシュが記載されている
- [ ] Issue #415へのリンクが追加されている
- [ ] バックアップブランチ情報が記載されている
- [ ] 復元コマンドが明記されている
- [ ] 復元時間が記載されている（1秒未満）

**エラーハンドリング**:
- 記録が不完全な場合、README.mdを再編集
- コミットハッシュが `<commit-hash>` のままの場合、実際のハッシュに置換

---

## 2.3 Jenkins動作確認テスト（オプション）

### INT-JENKINS-001: Jenkins V2ジョブの動作確認

**目的**: Jenkins環境でV2ジョブが正常動作し、V1削除の影響がないことを確認する

**優先度**: 低（推奨）

**前提条件**:
- Jenkins UIへのアクセス権限がある
- `AI_Workflow/ai_workflow_orchestrator` ジョブの実行権限がある
- V1削除が完了している

**テスト手順**:

#### Step 1: Jenkins UIアクセス
```bash
# Jenkins URLを確認（環境により異なる）
echo "Jenkins URL: <jenkins-url>"

# ブラウザでアクセス
# <jenkins-url>/job/AI_Workflow/job/ai_workflow_orchestrator/
```

#### Step 2: ジョブ実行
```
1. Jenkins UIにログイン
2. AI_Workflow/ai_workflow_orchestrator ジョブに移動
3. 「ビルド実行」をクリック
4. ビルド番号をクリックしてビルド画面に移動
5. 「Console Output」をクリックしてログを確認
```

#### Step 3: ログ確認
```bash
# ログ内でV1パス参照をチェック
# （Jenkins UIのConsole Output画面で手動確認）

# 確認項目:
# - "scripts/ai-workflow" という文字列が存在しないこと
# - "scripts/ai-workflow-v2" という文字列が使用されていること
# - エラーログが存在しないこと
# - ジョブが正常終了していること（緑色のチェックマーク）
```

**期待結果**:
- ✅ ジョブが正常終了する（緑色のチェックマーク）
- ✅ ログにエラーが存在しない
- ✅ ログにV1パス参照（`scripts/ai-workflow`）が存在しない
- ✅ ログにV2パス（`scripts/ai-workflow-v2`）が使用されている
- ✅ ジョブの実行時間が通常範囲内である

**確認項目**:
- [ ] ジョブが正常終了する
- [ ] ログにエラーがない
- [ ] V1パス参照がログに出現しない
- [ ] V2パスがログに使用されている
- [ ] ジョブ実行時間が正常範囲内

**エラーハンドリング**:
- ジョブが失敗する場合、ログを詳細確認
- V1参照が見つかった場合、即座にロールバック（1秒未満）
- エラーログを保存し、Issue #415に報告

**エラー時のロールバック手順**:
```bash
# 1. 現在の作業を破棄
git reset --hard HEAD

# 2. バックアップブランチから復元
git checkout archive/ai-workflow-v1-python -- scripts/ai-workflow/

# 3. 復元確認
ls -la scripts/ai-workflow/

# 4. Jenkins再確認
# Jenkins UIで再度ジョブを実行し、正常動作を確認
```

---

## 2.4 統合テストのテストマトリクス

| テストID | テスト内容 | 前提条件 | 期待結果 | 優先度 |
|---------|-----------|---------|---------|--------|
| INT-001 | バックアップブランチ作成確認 | Issue #411完了 | ブランチ存在、リモートにプッシュ済み | 高 |
| INT-002 | 復元時間測定（5分以内） | INT-001成功 | 復元時間5分以内（推奨1秒未満） | 高 |
| INT-003 | V1参照箇所の全数調査 | Phase 4完了 | V1参照0件、リンク切れなし | 高 |
| INT-008 | Git操作の検証 | Phase 4完了 | 削除コミット記録、約50ファイル削除 | 高 |
| INT-NEW-001 | ディレクトリ不存在確認 | Phase 4完了 | ディレクトリ存在しない | 高 |
| INT-NEW-002 | README変更履歴の更新確認 | Phase 4完了 | 削除情報が記録されている | 高 |
| INT-JENKINS-001 | Jenkins V2ジョブ動作確認 | Jenkins権限あり | ジョブ正常動作、V1参照なし | 低（推奨） |

**合計テスト数**: 7個（うち1個はオプション）

**必須テスト**: 6個（INT-001, INT-002, INT-003, INT-008, INT-NEW-001, INT-NEW-002）

**オプションテスト**: 1個（INT-JENKINS-001）

---

# 3. テストデータ

## 3.1 Git操作用テストデータ

### バックアップブランチ情報
- **ブランチ名**: `archive/ai-workflow-v1-python`
- **リモートリポジトリ**: `origin`
- **期待される状態**: 存在し、リモートにプッシュ済み

### 削除対象ディレクトリ
- **ディレクトリパス**: `scripts/ai-workflow/`
- **期待されるファイル数**: 約50個
- **サブディレクトリ**: `src/`, `tests/` 等

### コミットメッセージフォーマット
- **フォーマット**: `[scripts] remove: AI Workflow V1 (Python版) を削除`
- **本文に含むべき内容**:
  - 削除理由（V2への移行完了）
  - バックアップブランチ情報
  - 復元手順
  - Issue #411, #415へのリンク
- **禁止事項**: Co-Authorクレジット（CLAUDE.md line 364）

## 3.2 V1参照検索用テストデータ

### 検索パターン
- **パターン**: `scripts/ai-workflow`
- **除外ディレクトリ**: `.git`, `.ai-workflow`, `ai-workflow`
- **除外ファイル**: `*.md`（一部のテストで除外解除）

### 期待される検索結果
- **コードファイル内**: 0件
- **マークダウンファイル内**: 0件（リンク切れなし）
- **Jenkins設定ファイル内**: 0件

## 3.3 Jenkins動作確認用テストデータ

### Jenkins環境情報
- **ジョブ名**: `AI_Workflow/ai_workflow_orchestrator`
- **Jenkins URL**: `<jenkins-url>`（環境により異なる）
- **期待されるログパターン**:
  - ✅ `scripts/ai-workflow-v2` が使用されている
  - ❌ `scripts/ai-workflow` が使用されていない（V1参照）
  - ✅ エラーログが存在しない

---

# 4. テスト環境要件

## 4.1 Git環境

### 必須要件
- **Git**: バージョン2.0以上
- **リモートリポジトリアクセス**: プッシュ・プル権限
- **ブランチ操作権限**: 作成・削除権限

### オプション要件
- **GitHub CLI (gh)**: Issue操作用（Issue #411へのコメント投稿）

## 4.2 Jenkins環境（オプション）

### アクセス要件
- **Jenkins UI**: アクセス権限
- **ジョブ実行権限**: `AI_Workflow/ai_workflow_orchestrator` ジョブの実行権限
- **ログ閲覧権限**: Console Outputの閲覧権限

### 推奨環境
- Jenkins UIにアクセス可能なブラウザ
- ネットワーク接続（Jenkins URLへのアクセス）

## 4.3 ローカル環境

### 必須ツール
- **Bash**: テストスクリプト実行用
- **grep, find, sed, awk**: テストコマンド実行用
- **time**: 復元時間測定用

### 推奨設定
- 作業ディレクトリ: `/tmp/jenkins-59c0774e/workspace/AI_Workflow/ai_workflow_orchestrator`
- 十分なディスクスペース（V1復元テスト用）

## 4.4 モック/スタブの必要性

**不要**

**理由**:
- 統合テストのため、実際のGit操作を実行
- Jenkins動作確認も実環境で実施（オプション）
- モック/スタブは使用しない

---

# 5. テスト実行順序

## 5.1 推奨実行順序

```
Phase 4: Implementation（削除実行）
  ↓
Phase 6: Testing（本フェーズ）
  ↓
【ステップ1】 バックアップ関連テストの再実行
  ├─ INT-001: バックアップブランチ作成確認
  └─ INT-002: 復元時間測定
  ↓
【ステップ2】 削除確認テストの実行
  ├─ INT-003: V1参照箇所の全数調査
  ├─ INT-008: Git操作の検証
  ├─ INT-NEW-001: ディレクトリ不存在確認
  └─ INT-NEW-002: README変更履歴の更新確認
  ↓
【ステップ3】 Jenkins動作確認テスト（オプション）
  └─ INT-JENKINS-001: Jenkins V2ジョブ動作確認
```

## 5.2 依存関係

### 必須テストの依存関係
- **INT-001** → **INT-002**: バックアップ存在確認後に復元テスト
- **INT-002** → **INT-003**: 復元可能性確認後に参照チェック
- **INT-003** → **INT-008**: 参照0件確認後にGit操作検証
- **INT-008** → **INT-NEW-001**: Git操作確認後にディレクトリ不存在確認
- **INT-NEW-001** → **INT-NEW-002**: ディレクトリ削除確認後にドキュメント更新確認

### オプションテストの依存関係
- **INT-NEW-002** → **INT-JENKINS-001**: すべての必須テスト成功後にJenkins確認

## 5.3 並行実行の可能性

**なし**

**理由**:
- すべてのテストが依存関係を持つ
- 順次実行が必須
- 削除作業の性質上、慎重な順序実行が必要

---

# 6. エラーハンドリング戦略

## 6.1 テスト失敗時の対応

### レベル1: 警告（Warning）
**影響度**: 低
**対応**: テスト実行を継続、ログに記録

**例**:
- 復元時間が推奨値（1秒未満）を超えるが、必須値（5分以内）は満たす
- Jenkinsテスト（オプション）の失敗

### レベル2: エラー（Error）
**影響度**: 中
**対応**: テスト実行を中止、問題を修正してから再実行

**例**:
- V1参照が見つかる（INT-003失敗）
- ディレクトリが削除されていない（INT-NEW-001失敗）
- コミットメッセージが規約違反（INT-008失敗）

### レベル3: クリティカル（Critical）
**影響度**: 高
**対応**: 即座にロールバック、削除作業をやり直し

**例**:
- バックアップブランチが存在しない（INT-001失敗）
- 復元が5分以内にできない（INT-002失敗）
- 復元内容が不完全（INT-002失敗）

## 6.2 ロールバック手順

### 適用タイミング
- レベル3（クリティカル）エラー発生時
- Jenkinsテスト失敗時（V1参照が見つかった場合）
- その他、削除実行の継続が困難と判断された場合

### ロールバック実行手順
```bash
# 1. 現在の作業を破棄
git reset --hard HEAD

# 2. バックアップブランチから復元
git checkout archive/ai-workflow-v1-python -- scripts/ai-workflow/

# 3. 復元確認
ls -la scripts/ai-workflow/

# 4. 復元時間測定（検証）
time git checkout archive/ai-workflow-v1-python -- scripts/ai-workflow/

# 5. 復元後の動作確認
cd scripts/ai-workflow/
./main.py --version  # V1が正常動作することを確認

# 6. 問題解決後、再度削除実行を計画
```

### 復元所要時間
**期待値**: 1秒未満（Issue #411のINT-002で検証済み）

## 6.3 テスト結果の記録

### 成功時の記録
```markdown
| テストID | 結果 | 実行時間 | 備考 |
|---------|------|---------|------|
| INT-001 | ✅ 成功 | 2秒 | バックアップブランチ存在確認 |
| INT-002 | ✅ 成功 | 0.8秒 | 復元時間1秒未満（推奨値達成） |
```

### 失敗時の記録
```markdown
| テストID | 結果 | エラー内容 | 対応 |
|---------|------|-----------|------|
| INT-003 | ❌ 失敗 | V1参照が3件見つかった | 参照箇所を修正後、再実行 |
```

---

# 7. 品質ゲート確認

本テストシナリオは、Phase 3の品質ゲートを満たしています：

## 品質ゲート1: Phase 2の戦略に沿ったテストシナリオである

✅ **達成**

**根拠**:
- Phase 2で決定されたテスト戦略（INTEGRATION_ONLY）に厳密に準拠
- 統合テストシナリオのみを作成（ユニットテスト、BDDテストは含まない）
- テストコード戦略（EXTEND_TEST）に基づき、Issue #411の既存テスト12個を再利用
- 追加検証項目は削除後の最終確認のみ（新規テストファイル作成なし）

## 品質ゲート2: 主要な正常系がカバーされている

✅ **達成**

**根拠**:
- **バックアップと復元**: INT-001（ブランチ存在確認）、INT-002（復元時間測定）
- **削除確認**: INT-003（V1参照0件）、INT-008（Git操作検証）、INT-NEW-001（ディレクトリ不存在）
- **ドキュメント更新**: INT-NEW-002（README変更履歴確認）
- **Jenkins動作確認**: INT-JENKINS-001（V2ジョブ正常動作、オプション）

**カバレッジ**: 必須6テスト + オプション1テスト = 7テスト

## 品質ゲート3: 主要な異常系がカバーされている

✅ **達成**

**根拠**:
- **バックアップ不存在**: INT-001でバックアップブランチが存在しない場合のエラーハンドリング
- **復元失敗**: INT-002で復元時間が5分を超える場合の対応
- **V1参照残存**: INT-003でV1参照が見つかった場合の削除作業中止
- **コミット不備**: INT-008でコミットメッセージが規約違反の場合の修正手順
- **ディレクトリ残存**: INT-NEW-001でディレクトリが削除されていない場合の再確認
- **Jenkins失敗**: INT-JENKINS-001でV2ジョブが失敗した場合の即座ロールバック

**エラーレベル**: 警告（Warning）、エラー（Error）、クリティカル（Critical）の3段階で分類

## 品質ゲート4: 期待結果が明確である

✅ **達成**

**根拠**:
- すべてのテストシナリオに「期待結果」セクションを記載
- 期待結果は検証可能な形式で記述（例: "バックアップブランチが存在する"、"復元時間が5分以内"）
- 確認項目をチェックリスト形式で明記
- 期待される出力例を記載（例: `<commit-hash> refs/heads/archive/ai-workflow-v1-python`）
- パフォーマンス基準を数値で明記（例: 必須5分以内、推奨1秒未満）

---

# 8. 補足情報

## 8.1 Issue #411との関係

本Issueは、Issue #411（AI Workflow V1からV2への移行）のフォローアップです。

### Issue #411で実施済みのテスト
Issue #411では12個の統合テストを実施し、すべて成功（成功率100%）しました：

1. INT-001: バックアップブランチ作成確認
2. INT-002: 復元時間測定（1秒未満を記録）
3. INT-003: V1参照箇所の全数調査（0件確認）
4. INT-004: DEPRECATED.md作成確認
5. INT-005: Jenkins DSLファイル確認
6. INT-006: Jenkinsfile確認
7. INT-007: Jenkins README確認
8. INT-008: Git操作の検証
9. INT-009: README変更履歴の確認
10. INT-010: バックアップブランチのリモート確認
11. INT-011: 復元後の動作確認
12. INT-012: V1参照の完全削除検証

### Issue #415で再実行するテスト
本Issueでは、Issue #411のテストのうち、以下の4つを再実行します：

- INT-001: バックアップブランチ作成確認
- INT-002: 復元時間測定
- INT-003: V1参照箇所の全数調査
- INT-008: Git操作の検証

### Issue #415で追加するテスト
削除後の最終確認として、以下の2つのテストを追加します：

- INT-NEW-001: ディレクトリ不存在確認
- INT-NEW-002: README変更履歴の更新確認

### Issue #415でオプションのテスト
推奨事項として、以下のテストを追加します：

- INT-JENKINS-001: Jenkins V2ジョブ動作確認

## 8.2 成功基準（Success Criteria）との対応

Planning Documentで定義された6つの成功基準と、各テストシナリオの対応関係：

| 成功基準 | 対応するテスト | 検証内容 |
|---------|--------------|---------|
| 1. 削除完了 | INT-NEW-001, INT-008 | ディレクトリ不存在、削除コミット記録 |
| 2. バックアップ確保 | INT-001, INT-002 | ブランチ存在、復元可能（1秒未満） |
| 3. ドキュメント更新 | INT-NEW-002 | README変更履歴に削除情報記録 |
| 4. テスト成功 | すべてのテスト | 統合テスト7個すべて成功 |
| 5. 完了報告 | （Phase 8で実施） | Issue #411へのコメント投稿 |
| 6. 安全性確保 | INT-002 | 即座に復元可能（1秒未満） |

## 8.3 テスト実行タイミング

### Phase 4: Implementation完了後
- Task 4-1~4-4が完了した直後にテスト実行を開始
- 削除コミットがリモートにプッシュされていることを確認

### Phase 6: Testing
- 本フェーズでテストシナリオを実行
- すべての必須テスト（6個）が成功することを確認
- オプションテスト（1個）は推奨だが必須ではない

### 失敗時の再実行
- テスト失敗時は問題を修正してから再実行
- クリティカルエラー時は即座にロールバック

---

**テストシナリオバージョン**: v1.0
**作成日**: 2025年
**最終更新日**: 2025年
**作成者**: Claude AI (AI Workflow Test Scenario Agent)
